;; TODO: rename the test. this is actually a tail call test

(def print mrat.core.io.print)

(def (cons car cdr)
  (concat (list car) cdr))

(def (= a b) (eq? a b))

(def (<= a b)
  (or (< a b) (= a b)))

(def (>= a b)
  (or (> a b) (= a b)))

(def (range beg end)
  (let ((range-internal
         (fn range-internal (suffix beg end)
           (if (>= beg end)
             suffix
             ;; TODO: implement tail recursion
             (range-internal (cons (- end 1) suffix) beg (- end 1))))))
    (if (<= beg end)
      (range-internal '() beg end)
      '())))

(print (length (range 0 10)))
;;(print (length (range 0 1000000)))
