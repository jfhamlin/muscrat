(load-file "./testtab.mrat")
(load-file "./functional00.in")

(def print mrat.core.io/print)

(def tbl
  '((#t #t)
    (#t #f)
    (#f #t)
    (#f #f)
    (nil #t)
    (nil #f)
    (#t nil)
    (#f nil)))

(defn pret [val]
  ;; print val then return it
  (print "eval" val)
  val)

;;; AND

(defn testAnd [bools]
  (if (empty? bools)
    #t
    (and (pret (first bools))
         (testAnd (rest bools)))))

(print "### AND")
(testTable tbl
           (fn [bools]
             (print bools "=>" (testAnd bools))))

;;; OR

(defn testOr [bools]
  (if (empty? bools)
    #f
    (or (pret (first bools))
         (testOr (rest bools)))))

(print)
(print "### OR")
(testTable tbl
           (fn [bools]
             (print bools "=>" (testOr bools))))

;; bool conversion
(print)
(print "### bool conversion")
(print (and #t 2))
(print (or #f 1))
